---
title: IPMI
layout: default
---

Useful IPMI commands on SuperMicro AOC-IPMI20 for Serial-Over-LAN
Console

SuperMicro ipmitool
-------------------

    # service ipmi stop

SuperMicro Configuration Tool Began to work

    # ./ipmicfg-linux.x86_64.static -m
    IP=192.168.1.21 MAC=00:30:48:56:A8:14
    # ./ipmicfg-linux.x86_64.static -k
    Net Mask=255.255.255.0
    # ./ipmicfg-linux.x86_64.static -dhcp
    DHCP is currently disabled.
    # ./ipmicfg-linux.x86_64.static -g
    IP=192.168.1.1
    # ./ipmicfg-linux.x86_64.static -ver
    Firmware Revision: 02.05
    # ./ipmicfg-linux.x86_64.static -vlan
    VLAN feature is not supported by this firmware.

-   <https://twiki.cern.ch/twiki/bin/view/FIOgroup/IpmiRefSolSetup>
-   <http://wiki.alteeve.com/index.php/IPMI>

Common ipmitool commands
------------------------

    # ipmitool -l open shell
    # ipmitool -l open mc reset cold
    # ipmitool -I open lan print
    # ipmitool -l open session info all

Set higher baudrate on BMC
--------------------------

-   IPMIv2 only uses CTS/RTS (RTS/CTS);

<!-- -->

    # ipmitool -l open sol info 1
    # ipmitool -l open sol set help
    # ipmitool -l open sol set volatile-bit-rate 115.2 1
    # ipmitool -l open sol set non-volatile-bit-rate 115.2 1

Remote IPMI shell
-----------------

    # ipmitool -I lanplus -H 192.168.1.21 -U ADMIN shell
    # ipmitool -I lanplus -H 192.168.1.21 -U ADMIN sol activate
    # ipmitool -I lanplus -H 192.168.1.21 -U ADMIN chassis power reset

rmcp\_ping
----------

    # rmcp_ping
    # rmcp_ping 192.168.1.21

Fedora ??12?? grub.conf
-----------------------

    # grub.conf generated by anaconda
    #
    # Note that you do not have to rerun grub after making changes to this file
    # NOTICE:  You have a /boot partition.  This means that
    #          all kernel and initrd paths are relative to /boot/, eg.
    #          root (hd0,0)
    #          kernel /vmlinuz-version ro root=/dev/VolGroup00/LogVol00
    #          initrd /initrd-version.img
    #boot=/dev/sda

    # Redirect grub output to serial console, which is on COM Port 2
    serial --unit=1 --speed=19200 --word=8 --parity=no --stop=1   
    terminal --timeout=10 serial console

    default=0
    timeout=10

    # making IPMI friendly
    #splashimage=(hd0,0)/grub/splash.xpm.gz
    #hiddenmenu

    title CentOS (2.6.18-92.1.22.el5)
        root (hd0,0)
        kernel /vmlinuz-2.6.18-92.1.22.el5 ro root=/dev/VolGroup00/LogVol00 console=tty0 console=ttyS1,19200n8
        initrd /initrd-2.6.18-92.1.22.el5.img
    title "My bios update"
        kernel /memdisk
        initrd /fwdisk.img floppy

Fedora 14 grub.conf
-------------------

-   Set higher buadrate

<!-- -->

    # cat /etc/grub.conf 
    # grub.conf generated by anaconda
    #
    # Note that you do not have to rerun grub after making changes to this file
    # NOTICE:  You have a /boot partition.  This means that
    #          all kernel and initrd paths are relative to /boot/, eg.
    #          root (hd0,0)
    #          kernel /vmlinuz-version ro root=/dev/mapper/vg_drewserv-lv_root
    #          initrd /initrd-[generic-]version.img
    #boot=/dev/sda
    serial --unit=1 --speed=115200
    terminal --timeout=5 serial console
    default=5
    timeout=10
    #splashimage=(hd0,0)/grub/splash.xpm.gz
    #hiddenmenu
    title Fedora (2.6.35.11-83.fc14.x86_64)
        root (hd0,0)
        kernel /vmlinuz-2.6.35.11-83.fc14.x86_64 ro root=/dev/mapper/vg_drewserv-lv_root rd_LVM_LV=vg_drewserv/lv_root rd_LVM_LV=vg_drewserv/lv_swap rd_NO_LUKS rd_NO_MD rd_NO_DM console=tty0 console=ttyS1,115200
        initrd /initramfs-2.6.35.11-83.fc14.x86_64.img

Fedora14 grub.conf orig
-----------------------

grub.conf

1.  grub.conf generated by anaconda
2.  3.  Note that you do not have to rerun grub after making changes to
    this file
4.  NOTICE: You have a /boot partition. This means that
5.  all kernel and initrd paths are relative to /boot/, eg.
6.  root (hd0,0)
7.  kernel /vmlinuz-version ro root=/dev/mapper/vg\_drewserv-lv\_root
8.  initrd /initrd-\[generic-\]version.img
9.  boot=/dev/sda

serial --unit=1 --speed=19200 terminal --timeout=5 serial console
default=5 timeout=5

1.  splashimage=(hd0,0)/grub/splash.xpm.gz
2.  hiddenmenu

title Fedora (2.6.35.11-83.fc14.x86\_64)

`       root (hd0,0)`  
`       kernel /vmlinuz-2.6.35.11-83.fc14.x86_64 ro root=/dev/mapper/vg_drewserv-lv_root rd_LVM_LV=vg_drewserv/lv_root rd_LVM_LV=vg_drewserv/lv_swap rd_NO_LUKS rd_NO_MD rd_NO_DM LANG=en_US.UTF-8 SYSFONT=latarcyrheb-sun16 KEYTABLE=us rhgb quiet console=ttyS1,19200`  
`       initrd /initramfs-2.6.35.11-83.fc14.x86_64.img`

Using the Serial BIOS
---------------------

-   <http://buttersideup.com/docs/howto/IPMI_on_Debian.html>
-   The serial BIOS interface is a bit brain damaged in that it does not
    recognise the “F11”, and “F12” key escape codes that most terminal
    programs send, instead you can send “Esc-!”, and “Esc-@” (yes very
    logical, as long as the '@' key is normally typed using 'Shift-2' -
    as on US keyboards, not miles away from the '2' key, as on many
    non-US keyboards). These escapes from HP, and Dell serial BIOS' may
    or may not be useful:

<!-- -->

    Defined As     F1     F2     F3     F4     F5     F6     F7     F8     F9     F10    F11    F12
    Keyboard Entry <ESC>1 <ESC>2 <ESC>3 <ESC>4 <ESC>5 <ESC>6 <ESC>7 <ESC>8 <ESC>9 <ESC>0 <ESC>! <ESC>@

    Defined As     Home   End    Insert Delete PageUp PageDn
    Keyboard Entry <ESC>h <ESC>k <ESC>+ <ESC>- <ESC>? <ESC>/

    Use the <ESC><Ctrl><M> key sequence for <Ctrl><M>

    Use the <ESC><Ctrl><H> key sequence for <Ctrl><H>

    Use the <ESC><Ctrl><I> key sequence for <Ctrl><I>

    Use the <ESC><Ctrl><J> key sequence for <Ctrl><J>

    Use the <ESC><X><X> key sequence for <Alt><x>, where x is any letter key, and X is the upper case of that key

Fedora 13
---------

-   Set console=ttyS1,19200n8 last for udev to automatically configure
    serial console on boot.

